

(* :Title: FCCanonicalizeDummyIndices.test									*)

(*
	This software is covered by the GNU General Public License 3.
	Copyright (C) 1990-2016 Rolf Mertig
	Copyright (C) 1997-2016 Frederik Orellana
	Copyright (C) 2014-2016 Vladyslav Shtabovenko
*)

(* :Summary:  Framework independent unit tests for
				FCCanonicalizeDummyIndices									*)

(* ------------------------------------------------------------------------ *)

Tests`Lorentz`fcstFCCanonicalizeDummyIndices =
({
{"fcstFCCanonicalizeDummyIndices-ID1",
"MatchQ[tmp=FCCanonicalizeDummyIndices[FVD[q,mu] \
FVD[p,mu]+FVD[q,nu] FVD[p,nu]];FCE[tmp],2 FVD[p,i_] FVD[q,i_]]",
"True"},
{"fcstFCCanonicalizeDummyIndices-ID2",
"FCCanonicalizeDummyIndices[Uncontract[SP[q,p]^4,q,p,Pair\[Rule]\
All],LorentzIndexNames\[Rule]{mu,nu,rho,si}]//FCE",
"FV[p, mu]*FV[p, nu]*FV[p, rho]*FV[p, si]*FV[q, mu]*FV[q, \
nu]*FV[q, rho]*FV[q, si]"},
{"fcstFCCanonicalizeDummyIndices-ID3",
"MatchQ[FCCanonicalizeDummyIndices[FV[p1,mu](FV[p2,nu]FV[p3,nu]+FV[\
p2,rho]FV[p3,rho])]//FCE,2 FV[p1,mu] \
Pair[LorentzIndex[a_],Momentum[p2]] \
Pair[LorentzIndex[a_],Momentum[p3]]]", "True"},
{"fcstFCCanonicalizeDummyIndices-ID4",
"MatchQ[FV[p1,mu](FV[p2,nu]FV[p3,nu]+FV[p2,rho]FV[p3,rho])\
//FCCanonicalizeDummyIndices[#,LorentzIndexNames\[Rule]{al}]&//FCE,2 \
FV[p1,mu] FV[p2,a_] FV[p3,a_]]", "True"},
{"fcstFCCanonicalizeDummyIndices-ID5",
"MatchQ[tmp=FCE[FCCanonicalizeDummyIndices[SUNTF[a,b,c]v1[\
SUNFIndex[b]]v1[SUNFIndex[c]]+SUNTF[a,bp,cp]v1[SUNFIndex[bp]]v1[\
SUNFIndex[cp]]]];FCE[tmp],2 SUNTF[{a},x_,y_] v1[SUNFIndex[x_]] \
v1[SUNFIndex[y_]]]", "True"},
{"fcstFCCanonicalizeDummyIndices-ID6",
"FCCanonicalizeDummyIndices[SUNTF[a,b,c]v1[SUNFIndex[b]]v1[\
SUNFIndex[c]]+SUNTF[a,bp,cp]v1[SUNFIndex[bp]]v1[SUNFIndex[cp]],\
SUNFIndexNames\[Rule]{bb,cc}]//FCE",
"2*SUNTF[{a}, bb, cc]*v1[SUNFIndex[bb]]*v1[SUNFIndex[cc]]"},
{"fcstFCCanonicalizeDummyIndices-ID7",
"MatchQ[tmp=MT[mu,nu]FV[p,nu]SUNTF[a,b1,c1]v1[SUNFIndex[b1]]v1[\
SUNFIndex[c1]]SUNTF[a,b2,c2]v1[SUNFIndex[b2]]v2[SUNFIndex[c2]]\
//FCCanonicalizeDummyIndices;FCE[tmp],FV[p,a_] MT[mu,a_] \
SUNTF[{b_},c_,d_] SUNTF[{b_},e_,f_] v1[SUNFIndex[c_]] \
v1[SUNFIndex[e_]] v1[SUNFIndex[d_]] v2[SUNFIndex[f_]]]", "True"},
{"fcstFCCanonicalizeDummyIndices-ID8",
"MT[mu,nu]FV[p,nu]SUNTF[a,b1,c1]v1[SUNFIndex[b1]]v1[SUNFIndex[c1]]\
SUNTF[a,b2,c2]v1[SUNFIndex[b2]]v2[SUNFIndex[c2]]\
//FCCanonicalizeDummyIndices[#,LorentzIndexNames\[Rule]{li1},\
SUNFIndexNames\[Rule]{sf1,sf2,sf3,sf4},SUNIndexNames\[Rule]{cf1}]&\
//FCE", "FV[p, li1]*MT[li1, mu]*SUNTF[{cf1}, sf1, sf2]*SUNTF[{cf1}, sf3,
sf4]*v1[SUNFIndex[sf1]]*v1[SUNFIndex[sf2]]*v1[SUNFIndex[sf3]]*v2[SUNFIndex[sf4]]"},
{"fcstFCCanonicalizeDummyIndices-ID9",
"MatchQ[FCCanonicalizeDummyIndices[
T1[MyIndex2[a], MyIndex1[b]] v1[MyIndex1[b]] v2[MyIndex2[a]] +
T1[MyIndex2[c], MyIndex1[f]] v1[MyIndex1[f]] v2[MyIndex2[c]],
Head -> {MyIndex1, MyIndex2}],
2 T1[MyIndex2[MyIndex2head[a1_]], MyIndex1[MyIndex1head[a2_]]] v1[
MyIndex1[MyIndex1head[a2_]]] v2[MyIndex2[MyIndex2head[a1_]]]]", "True"},
{"fcstFCCanonicalizeDummyIndices-ID10",
"FCCanonicalizeDummyIndices[
T1[MyIndex2[a], MyIndex1[b]] v1[MyIndex1[b]] v2[MyIndex2[a]] +
T1[MyIndex2[c], MyIndex1[f]] v1[MyIndex1[f]] v2[MyIndex2[c]],
Head -> {MyIndex1, MyIndex2},
CustomIndexNames -> {{MyIndex1, {i1}}, {MyIndex2, {i2}}}]", "2 T1[MyIndex2[i2], MyIndex1[i1]] v1[MyIndex1[i1]] v2[MyIndex2[i2]]"},

{"fcstFCCanonicalizeDummyIndices-ID11","MatchQ[FCCanonicalizeDummyIndices[(Tens1[SUNIndex[a],
	SUNIndex[b]] Tens2[SUNIndex[a], SUNIndex[b]] +
	Tens1[SUNIndex[b], SUNIndex[a]] Tens2[SUNIndex[b], SUNIndex[a]])],
2 Tens1[SUNIndex[a_], SUNIndex[b_]] Tens2[SUNIndex[a_],
SUNIndex[b_]]]","True"},
{"fcstFCCanonicalizeDummyIndices-ID12","MatchQ[FCCanonicalizeDummyIndices[
Tens1[LorentzIndex[a], LorentzIndex[b]] Tens2[LorentzIndex[a], LorentzIndex[b]] +
Tens1[LorentzIndex[b], LorentzIndex[a]] Tens2[LorentzIndex[b], LorentzIndex[a]]],
2 Tens1[LorentzIndex[a_], LorentzIndex[b_]] Tens2[LorentzIndex[a_], LorentzIndex[b_]]]","True"},
{"fcstFCCanonicalizeDummyIndices-ID13","MatchQ[QuantumField[FCPartialD[LorentzIndex[\[Mu]]], GaugeField,
	LorentzIndex[\[Nu]], SUNIndex[a]].QuantumField[
	FCPartialD[LorentzIndex[\[Mu]]], GaugeField, LorentzIndex[\[Nu]],
	SUNIndex[a]] +
QuantumField[FCPartialD[LorentzIndex[\[Nu]]], GaugeField,
	LorentzIndex[\[Mu]], SUNIndex[a]].QuantumField[
	FCPartialD[LorentzIndex[\[Nu]]], GaugeField, LorentzIndex[\[Mu]],
	SUNIndex[a]] // FCCanonicalizeDummyIndices,
2 QuantumField[FCPartialD[LorentzIndex[a_]], GaugeField,
	LorentzIndex[c_], SUNIndex[b_]].QuantumField[
	FCPartialD[LorentzIndex[a_]], GaugeField, LorentzIndex[c_],
	SUNIndex[b_]]]","True"},
{"fcstFCCanonicalizeDummyIndices-ID12","FCCanonicalizeDummyIndices[
Spinor[Momentum[pE2, D], 0,
	1].(-((I EL GA[6] me)/(Sqrt[2] me sw))).(GSD[-k + pE2 - pS] +
	me).(-((I EL GA[7] me)/(
	Sqrt[2] me sw))).Spinor[-Momentum[pE1, D], 0,
	1] Spinor[-Momentum[pS, D], ms,
	1].((I EL mU  GA[6] SDF[Col1, Col2])/(Sqrt[2] me sw) - (
	I EL GA[7] SDF[Col1, Col2] ms)/(Sqrt[2] me sw)).(mU + GSD[k]).((
	I EL mU VUb GA[7])/(Sqrt[2] me sw) - (I EL VUb GA[6] mb)/(
	Sqrt[2] me sw)).Spinor[Momentum[pB, D], mb, 1] FAD[{k,
	mU}, {k + pS, Sqrt[GaugeXi[W]] me}, {k - pE2 + pS,
	me}, {k - pE1 - pE2 + pS, Sqrt[GaugeXi[W]] me}]]","(EL^2*mb*mU^2*VUb*Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[6] .
	DiracGamma[6] . Spinor[Momentum[pB, D], mb, 1]*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
FeynAmpDenominator[PropagatorDenominator[Momentum[k, D], mU],
	PropagatorDenominator[Momentum[k, D] + Momentum[pS, D],
	me*Sqrt[GaugeXi[W]]], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE2, D] + Momentum[pS, D], me],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE1, D] -
	Momentum[pE2, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*
SUNFDelta[SUNFIndex[Col1], SUNFIndex[Col2]])/(2*me^2*sw^2) -
(EL^2*mU^3*VUb*Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[6] .
	DiracGamma[7] . Spinor[Momentum[pB, D], mb, 1]*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
FeynAmpDenominator[PropagatorDenominator[Momentum[k, D], mU],
	PropagatorDenominator[Momentum[k, D] + Momentum[pS, D],
	me*Sqrt[GaugeXi[W]]], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE2, D] + Momentum[pS, D], me],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE1, D] -
	Momentum[pE2, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*
SUNFDelta[SUNFIndex[Col1], SUNFIndex[Col2]])/(2*me^2*sw^2) -
(EL^2*mb*ms*mU*VUb*Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[7] .
	DiracGamma[6] . Spinor[Momentum[pB, D], mb, 1]*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
FeynAmpDenominator[PropagatorDenominator[Momentum[k, D], mU],
	PropagatorDenominator[Momentum[k, D] + Momentum[pS, D],
	me*Sqrt[GaugeXi[W]]], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE2, D] + Momentum[pS, D], me],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE1, D] -
	Momentum[pE2, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*
SUNFDelta[SUNFIndex[Col1], SUNFIndex[Col2]])/(2*me^2*sw^2) +
(EL^2*ms*mU^2*VUb*Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[7] .
	DiracGamma[7] . Spinor[Momentum[pB, D], mb, 1]*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
FeynAmpDenominator[PropagatorDenominator[Momentum[k, D], mU],
	PropagatorDenominator[Momentum[k, D] + Momentum[pS, D],
	me*Sqrt[GaugeXi[W]]], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE2, D] + Momentum[pS, D], me],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE1, D] -
	Momentum[pE2, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*
SUNFDelta[SUNFIndex[Col1], SUNFIndex[Col2]])/(2*me^2*sw^2) +
(EL^2*mb*mU*VUb*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[6] .
	DiracGamma[Momentum[k, D], D] . DiracGamma[6] .
	Spinor[Momentum[pB, D], mb, 1]*FeynAmpDenominator[
	PropagatorDenominator[Momentum[k, D], mU], PropagatorDenominator[
	Momentum[k, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE2, D] +
	Momentum[pS, D], me], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE1, D] - Momentum[pE2, D] +
	Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*SUNFDelta[SUNFIndex[Col1],
	SUNFIndex[Col2]])/(2*me^2*sw^2) -
(EL^2*mU^2*VUb*(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] .
		DiracGamma[6] . DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/
	(2*sw^2) - (EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[6] .
	DiracGamma[Momentum[k, D], D] . DiracGamma[7] .
	Spinor[Momentum[pB, D], mb, 1]*FeynAmpDenominator[
	PropagatorDenominator[Momentum[k, D], mU], PropagatorDenominator[
	Momentum[k, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE2, D] +
	Momentum[pS, D], me], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE1, D] - Momentum[pE2, D] +
	Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*SUNFDelta[SUNFIndex[Col1],
	SUNFIndex[Col2]])/(2*me^2*sw^2) -
(EL^2*mb*ms*VUb*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[7] .
	DiracGamma[Momentum[k, D], D] . DiracGamma[6] .
	Spinor[Momentum[pB, D], mb, 1]*FeynAmpDenominator[
	PropagatorDenominator[Momentum[k, D], mU], PropagatorDenominator[
	Momentum[k, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE2, D] +
	Momentum[pS, D], me], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE1, D] - Momentum[pE2, D] +
	Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*SUNFDelta[SUNFIndex[Col1],
	SUNFIndex[Col2]])/(2*me^2*sw^2) +
(EL^2*ms*mU*VUb*
(-(EL^2*me*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
		DiracGamma[7] . Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2) -
	(EL^2*Spinor[Momentum[pE2, D], 0, 1] . DiracGamma[6] .
	DiracGamma[Momentum[-k + pE2 - pS, D], D] . DiracGamma[7] .
	Spinor[-Momentum[pE1, D], 0, 1])/(2*sw^2))*
Spinor[-Momentum[pS, D], ms, 1] . DiracGamma[7] .
	DiracGamma[Momentum[k, D], D] . DiracGamma[7] .
	Spinor[Momentum[pB, D], mb, 1]*FeynAmpDenominator[
	PropagatorDenominator[Momentum[k, D], mU], PropagatorDenominator[
	Momentum[k, D] + Momentum[pS, D], me*Sqrt[GaugeXi[W]]],
	PropagatorDenominator[Momentum[k, D] - Momentum[pE2, D] +
	Momentum[pS, D], me], PropagatorDenominator[
	Momentum[k, D] - Momentum[pE1, D] - Momentum[pE2, D] +
	Momentum[pS, D], me*Sqrt[GaugeXi[W]]]]*SUNFDelta[SUNFIndex[Col1],
	SUNFIndex[Col2]])/(2*me^2*sw^2)"}

});
